apiVersion: v1
kind: Namespace
metadata: { name: demo }
---
apiVersion: apps/v1
kind: Deployment
metadata: { name: hello-v1, namespace: demo, labels: {app: hello, version: v1} }
spec:
  replicas: 1
  selector: {matchLabels: {app: hello, version: v1}}
  template:
    metadata: { labels: {app: hello, version: v1} }
    spec:
      containers:
      - name: app
        image: hashicorp/http-echo:0.2.3
        args: ["-text=hello v1", "-listen=:8080"]
        ports: [{containerPort: 8080, name: http}]
---
apiVersion: v1
kind: Service
metadata: { name: hello-v1, namespace: demo }
spec:
  selector: {app: hello, version: v1}
  ports: [{port: 80, targetPort: 8080}]
---
apiVersion: v1
kind: Service
metadata: { name: hello, namespace: demo }
spec:
  selector: {app: hello}
  ports: [{port: 80, targetPort: 8080}]
