apiVersion: apps/v1
kind: Deployment
metadata: { name: hello-v2, namespace: demo, labels: {app: hello, version: v2} }
spec:
  replicas: 1
  selector: {matchLabels: {app: hello, version: v2}}
  template:
    metadata: { labels: {app: hello, version: v2} }
    spec:
      containers:
      - name: app
        image: hashicorp/http-echo:0.2.3
        args: ["-text=hello v2", "-listen=:8080"]
        ports: [{containerPort: 8080, name: http}]
---
apiVersion: v1
kind: Service
metadata: { name: hello-v2, namespace: demo }
spec:
  selector: {app: hello, version: v2}
  ports: [{port: 80, targetPort: 8080}]
